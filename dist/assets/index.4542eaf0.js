import{d as e,r as a,w as t,o as n,p as o,m as l,c as s,a as i,b as r,i as c,e as d,f as u,g as h,h as m,j as p,n as f,k as g,l as C,q as v,v as _,s as y,t as b,u as k,x,y as w,F as T,z as S,A as L,B as $,C as V,D as F,E as M,G as N,H as W,I as D,J as I,K as U}from"./vendor.c668e9e7.js";!function(){const e=document.createElement("link").relList;if(!(e&&e.supports&&e.supports("modulepreload"))){for(const e of document.querySelectorAll('link[rel="modulepreload"]'))a(e);new MutationObserver((e=>{for(const t of e)if("childList"===t.type)for(const e of t.addedNodes)"LINK"===e.tagName&&"modulepreload"===e.rel&&a(e)})).observe(document,{childList:!0,subtree:!0})}function a(e){if(e.ep)return;e.ep=!0;const a=function(e){const a={};return e.integrity&&(a.integrity=e.integrity),e.referrerpolicy&&(a.referrerPolicy=e.referrerpolicy),"use-credentials"===e.crossorigin?a.credentials="include":"anonymous"===e.crossorigin?a.credentials="omit":a.credentials="same-origin",a}(e);fetch(e.href,a)}}();var z=e({props:{accordion:Boolean,modelValue:{type:[Array,String,Number],default:()=>[]}},emits:["update:modelValue","change"],setup(e,{emit:s}){const i=a([].concat(e.modelValue)),r=l(),c=a=>{i.value=[].concat(a);const t=e.accordion?i.value[0]:i.value;s("update:modelValue",t),s("change",t)},d=a=>{if(e.accordion)c(!i.value[0]&&0!==i.value[0]||i.value[0]!==a?a:"");else{const e=i.value.slice(0),t=e.indexOf(a);t>-1?e.splice(t,1):e.push(a),c(e)}};return t((()=>e.modelValue),(()=>{i.value=[].concat(e.modelValue)})),r.on("item-click",d),n((()=>{r.all.clear()})),o("collapse",{activeNames:i,collapseMitt:r}),{activeNames:i,setActiveNames:c,handleItemClick:d}}});const R={class:"cv-collapse el-collapse"};z.render=function(e,a,t,n,o,l){return r(),s("div",R,[i(e.$slots,"default")])};const A=()=>Math.floor(1e4*Math.random());var B=e({props:{title:{type:String,default:""},name:{type:[String,Number],default:()=>A()},disabled:Boolean,func:String},setup(e){const t=c("collapse"),n=null==t?void 0:t.collapseMitt,o=a({height:"auto",display:"block"}),l=a(0),s=a(!1),i=a(!1),r=a(!1),u=a(A());return{isActive:d((()=>(null==t?void 0:t.activeNames.value.indexOf(e.name))>-1)),contentWrapStyle:o,contentHeight:l,focusing:s,isClick:i,id:u,handleFocus:()=>{setTimeout((()=>{i.value?i.value=!1:s.value=!0}),50)},handleHeaderClick:()=>{e.disabled||(null==n||n.emit("item-click",e.name),s.value=!1,i.value=!0)},handleEnterClick:()=>{null==n||n.emit("item-click",e.name)},collapse:t,doThis:e=>{console.log("doThis!"+e)},checked:r}}});const E=["id","tabindex"],K=["id"],X={class:"el-collapse-item__content"};B.render=function(e,a,t,n,o,l){const c=u("el-checkbox"),d=u("el-collapse-transition");return r(),s("div",{class:f(["cv-collapse-item el-collapse-item",{"is-active":e.isActive,"is-disabled":e.disabled}])},[h("div",{id:`el-collapse-head-${e.id}`,class:f(["el-collapse-item__header",{focusing:e.focusing,"is-active":e.isActive}]),tabindex:e.disabled?-1:0,onClick:a[2]||(a[2]=(...a)=>e.handleHeaderClick&&e.handleHeaderClick(...a)),onKeyup:a[3]||(a[3]=g(p(((...a)=>e.handleEnterClick&&e.handleEnterClick(...a)),["stop"]),["space","enter"])),onFocus:a[4]||(a[4]=(...a)=>e.handleFocus&&e.handleFocus(...a)),onBlur:a[5]||(a[5]=a=>e.focusing=!1)},[m(c,{modelValue:e.checked,"onUpdate:modelValue":a[0]||(a[0]=a=>e.checked=a),onChange:e.doThis,onClick:a[1]||(a[1]=p((()=>{}),["stop"]))},null,8,["modelValue","onChange"]),i(e.$slots,"header"),h("i",{class:f(["el-collapse-item__arrow el-icon-arrow-right",{"is-active":e.isActive}])},null,2)],42,E),m(d,null,{default:C((()=>[v(h("div",{id:`el-collapse-content-${e.id}`,class:"el-collapse-item__wrap"},[h("div",X,[i(e.$slots,"default")])],8,K),[[_,e.isActive]])])),_:3})],2)};const Y={data:()=>({randomNumber:0}),props:{name:String},components:{CvCollapseItem:B},methods:{getRandom(){this.randomNumber=this.getRandomFromBackend()},getRandomFromBackend(){y.get("http://localhost:5000/api/").then((e=>{this.randomNumber=e.data})).catch((e=>{console.log(e)}))}},created(){this.getRandom()}},j=h("div",null,"Paint",-1);Y.render=function(e,a,t,n,o,l){const s=u("cv-collapse-item");return r(),b(s,{name:t.name},{header:C((()=>[j])),default:C((()=>[h("div",null,"CvFuncPaint "+k(o.randomNumber),1)])),_:1},8,["name"])};const P={data:()=>({argForm:{name:"",region:"",date1:"",date2:"",delivery:!1,type:[],resource:"",desc:""}}),props:{name:String,argForm0:{type:Object,default:()=>({name:"",region:"",date1:"",date2:"",delivery:!1,type:[],resource:"",desc:""})}},emits:["update:argForm"],components:{CvCollapseItem:B},methods:{onSubmit(){console.log("submit!")}},watch:{argForm:{handler(e,a){this.$emit("update:argForm",e),console.log("funcCut",e)},deep:!0}}},H=h("div",null,"Cut",-1),O=x("-"),q=x("立即创建"),G=x("取消");P.render=function(e,a,t,n,o,l){const s=u("el-input"),i=u("el-form-item"),c=u("el-option"),d=u("el-select"),h=u("el-date-picker"),p=u("el-col"),f=u("el-time-picker"),g=u("el-checkbox-button"),v=u("el-checkbox-group"),_=u("el-radio"),y=u("el-radio-group"),k=u("el-button"),x=u("el-form"),w=u("cv-collapse-item");return r(),b(w,{name:t.name},{header:C((()=>[H])),default:C((()=>[m(x,{ref:"form",model:o.argForm,"label-width":"80px",size:"mini"},{default:C((()=>[m(i,{label:"活动名称"},{default:C((()=>[m(s,{modelValue:o.argForm.name,"onUpdate:modelValue":a[0]||(a[0]=e=>o.argForm.name=e)},null,8,["modelValue"])])),_:1}),m(i,{label:"活动区域"},{default:C((()=>[m(d,{modelValue:o.argForm.region,"onUpdate:modelValue":a[1]||(a[1]=e=>o.argForm.region=e),placeholder:"请选择活动区域"},{default:C((()=>[m(c,{label:"区域一",value:"shanghai"}),m(c,{label:"区域二",value:"beijing"})])),_:1},8,["modelValue"])])),_:1}),m(i,{label:"活动时间"},{default:C((()=>[m(p,{span:11},{default:C((()=>[m(h,{type:"date",placeholder:"选择日期",modelValue:o.argForm.date1,"onUpdate:modelValue":a[2]||(a[2]=e=>o.argForm.date1=e),style:{width:"100%"}},null,8,["modelValue"])])),_:1}),m(p,{class:"line",span:2},{default:C((()=>[O])),_:1}),m(p,{span:11},{default:C((()=>[m(f,{placeholder:"选择时间",modelValue:o.argForm.date2,"onUpdate:modelValue":a[3]||(a[3]=e=>o.argForm.date2=e),style:{width:"100%"}},null,8,["modelValue"])])),_:1})])),_:1}),m(i,{label:"活动性质"},{default:C((()=>[m(v,{modelValue:o.argForm.type,"onUpdate:modelValue":a[4]||(a[4]=e=>o.argForm.type=e)},{default:C((()=>[m(g,{label:"美食/餐厅线上活动",name:"type"}),m(g,{label:"地推活动",name:"type"}),m(g,{label:"线下主题活动",name:"type"})])),_:1},8,["modelValue"])])),_:1}),m(i,{label:"特殊资源"},{default:C((()=>[m(y,{modelValue:o.argForm.resource,"onUpdate:modelValue":a[5]||(a[5]=e=>o.argForm.resource=e),size:"medium"},{default:C((()=>[m(_,{border:"",label:"线上品牌商赞助"}),m(_,{border:"",label:"线下场地免费"})])),_:1},8,["modelValue"])])),_:1}),m(i,null,{default:C((()=>[m(k,{type:"primary",onClick:l.onSubmit},{default:C((()=>[q])),_:1},8,["onClick"]),m(k,null,{default:C((()=>[G])),_:1})])),_:1})])),_:1},8,["model"])])),_:1},8,["name"])};const J={data:()=>({activeNames:[],change:"two"}),emits:["update:modelValue"],props:{func:String,name:String,modelValue:Array},components:{CvCollapse:z,CvFuncPaint:Y,CvFuncCut:P},methods:{handleChange(e){console.log(e),console.log("func",this.modelValue)}},computed:{getFullComName(){return"cv-func-"+this.func}}};J.render=function(e,a,t,n,o,l){const i=u("cv-collapse");return r(),b(i,{modelValue:o.activeNames,"onUpdate:modelValue":a[0]||(a[0]=e=>o.activeNames=e),onChange:l.handleChange},{default:C((()=>[(r(!0),s(T,null,w(t.modelValue,(e=>(r(),b(S("cv-func-"+e.func),{key:e.name,name:e.name,argForm:e.argForm,"onUpdate:argForm":a=>e.argForm=a},null,8,["name","argForm","onUpdate:argForm"])))),128))])),_:1},8,["modelValue","onChange"])},J.__scopeId="data-v-71df1d63";const Z={data:()=>({frameSrc:"/static/canvas.png",mCan_ctx:null,cCan_ctx:null,cWater_ctx:null,boxHeight:0,boxScale:1,cursorSize:20,isEmpty:!1,isDrawMoving:!1,isCanvasMoving:!1,canvasXc:0,canvasYc:0}),computed:{cusorScale(){return this.boxHeight/540},cusorStyle(){return{transform:`translate(-50%, -50%) scale(${this.cusorScale})`,width:this.annTool.brushSize+"px",height:this.annTool.brushSize+"px"}}},inject:["host","annTool","activeLabel"],created(){this.$nextTick((()=>{this.mCan_ctx=this.$refs.mCan.getContext("2d"),this.cCan_ctx=this.$refs.cCan.getContext("2d"),this.cWater_ctx=this.$refs.cWater.getContext("2d"),this.canvasPushdo(),document.body.addEventListener("mousemove",this.cursorMove),document.addEventListener("mousemove",this.drawMoving),document.addEventListener("mousemove",this.canvasMoving),document.addEventListener("mouseup",this.whenMouseUp),this.boxHeight=this.$refs.canBox.getBoundingClientRect().height})),this.$store.watch(((e,a)=>a.getUndoMCan),(e=>this.mCan_ctx.putImageData(this.$store.getters.toImgData(e),0,0))),this.$store.watch(((e,a)=>a.getUndoCCan),(e=>this.cCan_ctx.putImageData(this.$store.getters.toImgData(e),0,0)))},mounted(){y.defaults.baseURL=this.host,this.canvasInitsize()},methods:{cursorMove(e){let a=this.$refs.canWrapper.getBoundingClientRect();this.$refs.cursor.style.left=e.clientX-a.left+"px",this.$refs.cursor.style.top=e.clientY-a.top+"px"},whenMouseDown(e){0==e.button?(this.isdrawMoving=!0,this.drawMoving(e)):1==e.button&&(e.preventDefault&&e.preventDefault(),this.canvasXc=e.pageX-this.$refs.canBox.offsetLeft,this.canvasYc=e.pageY-this.$refs.canBox.offsetTop,this.isCanvasMoving=!0)},whenMouseUp(e){0==e.button&&this.isdrawMoving?(this.isdrawMoving=!1,this.canvasPushdo()):1==e.button&&(this.isCanvasMoving=!1)},drawMoving(e){if(!this.isdrawMoving)return;let a=this.$refs.cCan.getBoundingClientRect(),t=this.annTool.brushSize,n=this.annTool.brushSize/2,o=parseInt((e.clientX-a.left)/a.width*960-n),l=parseInt((e.clientY-a.top)/a.height*540-n);if(e.shiftKey){let e=2*this.annTool.brushSize;o-=n,l-=n,this.cCan_ctx.clearRect(o,l,e,e),this.mCan_ctx.clearRect(o,l,e,e)}else{this.cCan_ctx.fillStyle="#"+this.activeLabel.bgc,this.cCan_ctx.fillRect(o,l,t,t);let e=this.activeLabel.id.toString(16).padStart(2,"0");this.mCan_ctx.fillStyle="#"+e.repeat(3),this.mCan_ctx.fillRect(o,l,t,t),this.isEmpty=!1}},canvasMoving(e){this.isCanvasMoving&&(this.$refs.canBox.style.left=e.pageX-this.canvasXc+"px",this.$refs.canBox.style.top=e.pageY-this.canvasYc+"px")},whenMouseWheel(e){let a=e.wheelDelta>0?1:-1,t=.1*a;if(e.shiftKey){let e=this.boxScale+t;e>=.5&&(this.annTool.brushSize*=this.boxScale/e,this.boxScale+=t)}else this.annTool.brushSize+=a,this.annTool.brushSize<1?this.annTool.brushSize=1:this.annTool.brushSize>50&&(this.annTool.brushSize=50)},canvasClear(){this.cCan_ctx.clearRect(0,0,960,540),this.mCan_ctx.clearRect(0,0,960,540),this.isEmpty=!0,this.canvasPushdo()},canvasResize(){this.annTool.brushSize*=this.boxScale,this.boxScale=1,this.$refs.canBox.style.left="0px",this.$refs.canBox.style.top="0px"},canvasInitsize(){let e=this.$refs.canWrapper.getBoundingClientRect();e.width/e.height<16/9&&(this.$refs.canBox.style.height=e.width/e.height/16*900+"%")},canvasUndo(){this.$store.commit("canvasUndo")},canvasRedo(){this.$store.commit("canvasRedo")},canvasPushdo(){this.$store.commit("canvasPushdo",{cCanData:this.cCan_ctx.getImageData(0,0,960,540),mCanData:this.mCan_ctx.getImageData(0,0,960,540)})},genWater(){if(!this.isEmpty){console.time("genWater time");let e=this.mCan_ctx.getImageData(0,0,960,540),a=V.deflate(e.data,{level:6}),t=window.btoa(String.fromCharCode(...a));y.post("/api/send/gen_water",{num_now:this.annTool.frameNum,mask_canvas_b64:t}).then((a=>{var t=atob(a.data).split("").map((e=>e.charCodeAt(0))),n=new Uint8Array(t);let o=Uint8ClampedArray.from(V.inflate(n)),l=new ImageData(o,960,540);this.cWater_ctx.putImageData(l,0,0),this.annTool.isShowCWater=!0,this.$store.commit("storeCWater",{num:this.annTool.frameNum,imgData:l}),this.$store.commit("storeMCan",{num:this.annTool.frameNum,imgData:e});let s=this.cCan_ctx.getImageData(0,0,960,540);this.$store.commit("storeCCan",{num:this.annTool.frameNum,imgData:s}),console.timeEnd("genWater time")}))}},getFrame(e){this.cCan_ctx.clearRect(0,0,960,540),this.mCan_ctx.clearRect(0,0,960,540),this.isEmpty=!0,this.frameSrc=this.host+"/api/frame/"+e,this.$store.state.cWater_dic[e]?(this.annTool.isShowCWater=!0,this.cWater_ctx.putImageData(this.$store.getters.getCWater(e),0,0)):this.annTool.isShowCWater=!1,this.$store.state.mCan_dic[e]&&this.mCan_ctx.putImageData(this.$store.getters.getMCan(e),0,0),this.$store.state.cCan_dic[e]&&this.cCan_ctx.putImageData(this.$store.getters.getCCan(e),0,0),y.post("/api/send/get_frame",{frameNum:e}).then((function(e){}))}},watch:{boxScale(){this.$nextTick((()=>{this.boxHeight=this.$refs.canBox.getBoundingClientRect().height}))},"annTool.frameNum":{handler(e){this.getFrame(e)},deep:!0}}};L("data-v-47e9c20c");const Q={class:"workspace__canvas-wrapper",ref:"canWrapper"},ee=["src"],ae={class:"workspace__mask-canvas",width:"960",height:"540",ref:"mCan"},te={xmlns:"http://www.w3.org/2000/svg",version:"1.1"},ne=["width","height"];$(),Z.render=function(e,a,t,n,o,l){return r(),s("div",Q,[h("div",{class:"workspace__canvas-box",ref:"canBox",style:F({transform:`scale(${this.boxScale})`}),onMousedown:a[0]||(a[0]=e=>l.whenMouseDown(e)),onMousewheel:a[1]||(a[1]=e=>l.whenMouseWheel(e))},[h("img",{class:"workspace__frame",src:o.frameSrc,alt:""},null,8,ee),v(h("canvas",{class:"workspace__color-water",width:"960",height:"540",ref:"cWater",style:F({opacity:this.annTool.cWaterAlpha})},null,4),[[_,this.annTool.isShowCWater]]),h("canvas",ae,null,512),v(h("canvas",{class:"workspace__color-canvas",width:"960",height:"540",ref:"cCan",style:F({opacity:this.annTool.cCanAlpha})},null,4),[[_,this.annTool.isShowCCan]])],36),h("div",{class:"workspace__cursor",style:F(l.cusorStyle),ref:"cursor"},[(r(),s("svg",te,[h("rect",{width:l.annTool.brushSize,height:l.annTool.brushSize,style:F({fill:"#"+this.activeLabel.bgc})},null,12,ne)]))],4)],512)},Z.__scopeId="data-v-47e9c20c";const oe={props:["styles"],inject:["annTool"],data:()=>({chart:null,diffValue:null,options:{animation:!1,tooltip:{axisPointer:{type:"cross",label:{precision:0}}},grid:{top:10,bottom:25,left:10,right:15},xAxis:{type:"category"},yAxis:{splitNumber:3,axisLabel:{show:!1}},series:[{name:"diffValue",type:"bar",data:[]}],visualMap:{type:"piecewise",show:!1,pieces:[{min:1e7,color:"#FF9655"},{max:1e7}]}}}),mounted(){this.initChart()},methods:{initChart(){this.chart=M(this.$el),this.chart.setOption(this.options),this.chart.getZr().on("click",(e=>{const a=[e.offsetX,e.offsetY];if(this.chart.containPixel("grid",a)){let e=this.chart.convertFromPixel({seriesIndex:0},a);this.annTool.frameNum=e[0]+this.chart.getOption().series[0].data[0][0]}})),this.initData()},initData(){y.post("/api/get",{keys:["diffValue_cut"]}).then((e=>{let a=e.data.diffValue;a&&(this.diffValue=a.map(((e,a)=>[a,e])),this.updateChart(this.annTool.frameNum))}))},updateChart(e){if(!this.diffValue)return;let a=e-200,t=e+200;a<0?(a=0,t=400):t>this.diffValue.length&&(a=this.diffValue.length-400,t=this.diffValue.length),this.chart.setOption({xAxis:{type:"category"},series:[{name:"diffValue",data:this.diffValue.slice(a,t),markLine:{symbol:"none",label:{show:!1},silent:!0,lineStyle:{color:"#0bd699",width:3,type:"solid"},data:[{xAxis:e-a}]}}]})}},watch:{"annTool.frameNum":{handler(e){this.updateChart(e)},deep:!0}}};L("data-v-dd302454");const le={class:"e-charts"};$(),oe.render=function(e,a,t,n,o,l){return r(),s("div",le)},oe.__scopeId="data-v-dd302454";const se={components:{CvFunc:J,CvCollapse:z,CvCollapseItem:B,WorkSpace:Z,ECharts:oe},data:()=>({cvFunc:[{func:"cut",name:"func1",argForm:{}},{func:"cut",name:"func2",argForm:{}},{func:"cut",name:"func3",argForm:{}}],jumpMethod:2,annTool:{brushSize:20,cCanAlpha:.7,isShowCCan:!0,cWaterAlpha:.7,isShowCWater:!0,frameNum:0,frameStep:3},activeLabel:{},labelList:[],value1:1,labelKeyMap:{f:0,q:1,w:2,e:3,r:4,z:5,x:6,c:7,v:8},keyframes:[],gettingKeyframes:!1,outputText:""}),inject:["host"],computed:{undoLength(){return this.$store.state.cCan_undoL.length-1},redoLength(){return this.$store.state.cCan_redoL.length},cusorStyle(){return{transform:`translate(-50%, -50%) scale(${this.cusorScale})`,width:this.annTool.brushSize+"px",height:this.annTool.brushSize+"px"}}},methods:{onSubmit(){console.log("submit!")},handleChange(e){console.log(e)},doThis(e){console.log("doThis!"+e)},showfunc(){console.log(this.cvFunc)},whenClickLabel(e){Object.assign(this.activeLabel,e)},canvasClear(){this.$refs.workSpace.canvasClear()},canvasResize(){this.$refs.workSpace.canvasResize()},canvasUndo(){this.$refs.workSpace.canvasUndo()},canvasRedo(){this.$refs.workSpace.canvasRedo()},genWater(){this.$refs.workSpace.genWater()},preKeyframe(){if(!this.keyframes)return this.output("no keyframe");let e=this.keyframes.findIndex((e=>e>this.annTool.frameNum-1));this.annTool.frameNum=this.keyframes[e>0?e-1:this.keyframes.length-1]},nextKeyframe(){if(!this.keyframes)return this.output("no keyframe");let e=this.keyframes.find((e=>e>this.annTool.frameNum));this.annTool.frameNum=e||this.keyframes[0]},output(e){this.outputText+=e+"\n",this.$refs.output.scrollTop=this.$refs.output.scrollHeight},genKeyframes(){this.gettingKeyframes=!0;var e=new EventSource(this.host+"/api/ana_keyframes");e.onmessage=e=>this.output(e.data),e.onerror=a=>{e.close(),this.output("source.error")},e.addEventListener("yield_end",(a=>{e.close(),this.output(a.data),this.output("yield_end"),y.post("/api/get",{keys:["keyframes"]}).then((e=>this.keyframes=e.data.keyframes)),this.$refs.eCharts.initData()}))}},provide(){return{annTool:this.annTool,activeLabel:this.activeLabel}},mounted(){y.post("/api/get",{keys:["keyframes","labelList"]}).then((e=>{this.keyframes=e.data.keyframes,this.labelList=e.data.labelList,this.whenClickLabel(this.labelList[0]),this.annTool.frameNum=1,this.annTool.frameNum=0})),document.addEventListener("mousemove",(e=>{this.$refs.mouseInfo.innerHTML=`clientX${e.clientX},clientY${e.clientY}<br>screenX:${e.screenX},screenY${e.screenY}<br>pageX:${e.pageX},pageY:${e.pageY}<br>offsetX:${e.offsetX},offsetY${e.offsetY}<br>x:${e.x},y:${e.y}<br>movementX:${e.movementX},movementY:${e.movementY}`})),document.addEventListener("keydown",(e=>{if(this.output("keydown: "+e.key),e.key in this.labelKeyMap)this.whenClickLabel(this.labelList[this.labelKeyMap[e.key]]);else if(" "==e.key)this.genWater();else if("a"==e.key)0==this.jumpMethod?this.annTool.frameNum--:1==this.jumpMethod?this.annTool.frameNum-=this.annTool.frameStep:this.preKeyframe();else if("d"==e.key)0==this.jumpMethod?this.annTool.frameNum++:1==this.jumpMethod?this.annTool.frameNum+=this.annTool.frameStep:this.nextKeyframe();else if("g"==e.key)this.canvasClear();else{if("s"!=e.key)return;this.annTool.isShowCWater=!this.annTool.isShowCWater}}))}},ie=x("菜单"),re=x("保存"),ce=x("撤销"),de=x("重做"),ue=h("label",null,"笔刷大小",-1),he=h("label",null,"画布",-1),me=h("label",null,"分割结果",-1),pe=x("重置画布"),fe=x("清空画布"),ge=x("生成分割"),Ce={class:"ann-label__box"},ve=["onClick"],_e={class:"ann-label__id"},ye=["value"],be={style:{color:"royalblue"}},ke={key:0},xe={key:1},we=h("span",null,"未找到keyframes信息",-1),Te=x("上一帧"),Se=x("下一帧"),Le=x("步退"),$e=x("步进"),Ve=x("上一关键帧"),Fe=x("下一关键帧"),Me=x("跳帧"),Ne=x("跳步"),We=x("跳关键帧"),De={class:"mouse-info",ref:"mouseInfo"},Ie=x("下一关键帧"),Ue=x("Footer");se.render=function(e,a,t,n,o,l){const i=u("el-button"),c=u("el-col"),d=u("el-row"),p=u("el-header"),g=u("el-aside"),_=u("el-input-number"),y=u("el-form-item"),S=u("el-form"),L=u("el-radio-button"),$=u("el-radio-group"),V=u("work-space"),M=u("el-main"),D=u("e-charts"),I=u("el-footer"),U=u("el-container"),z=u("cv-func"),R=u("el-scrollbar");return r(),b(U,{style:{height:"100%"}},{default:C((()=>[m(p,{class:"page-header",height:"28px"},{default:C((()=>[m(d,{align:"middle",style:{width:"100%"}},{default:C((()=>[m(c,{span:8},{default:C((()=>[m(i,{type:"text",icon:"el-icon-edit"},{default:C((()=>[ie])),_:1}),m(i,{type:"text",icon:"el-icon-share"},{default:C((()=>[re])),_:1}),m(i,{type:"text",icon:"el-icon-delete"},{default:C((()=>[ce])),_:1}),m(i,{type:"text",icon:"el-icon-search"},{default:C((()=>[de])),_:1})])),_:1}),m(c,{span:16},{default:C((()=>[ue,v(h("input",{type:"number",min:"1",max:"50","onUpdate:modelValue":a[0]||(a[0]=e=>o.annTool.brushSize=e)},null,512),[[N,o.annTool.brushSize]]),he,v(h("input",{type:"number",min:"0",max:"1",step:"0.1","onUpdate:modelValue":a[1]||(a[1]=e=>o.annTool.cCanAlpha=e)},null,512),[[N,o.annTool.cCanAlpha]]),v(h("input",{type:"checkbox","onUpdate:modelValue":a[2]||(a[2]=e=>o.annTool.isShowCCan=e)},null,512),[[W,o.annTool.isShowCCan]]),me,v(h("input",{type:"number",min:"0",max:"1",step:"0.1","onUpdate:modelValue":a[3]||(a[3]=e=>o.annTool.cWaterAlpha=e)},null,512),[[N,o.annTool.cWaterAlpha]]),v(h("input",{type:"checkbox","onUpdate:modelValue":a[4]||(a[4]=e=>o.annTool.isShowCWater=e)},null,512),[[W,o.annTool.isShowCWater]]),m(i,{onClick:l.canvasResize},{default:C((()=>[pe])),_:1},8,["onClick"]),m(i,{onClick:l.canvasClear},{default:C((()=>[fe])),_:1},8,["onClick"]),m(i,{onClick:l.canvasUndo},{default:C((()=>[x("撤销 "+k(l.undoLength),1)])),_:1},8,["onClick"]),m(i,{onClick:l.canvasRedo},{default:C((()=>[x("反撤销 "+k(l.redoLength),1)])),_:1},8,["onClick"]),m(i,{onClick:l.genWater},{default:C((()=>[ge])),_:1},8,["onClick"])])),_:1})])),_:1})])),_:1}),m(U,{class:"page-body"},{default:C((()=>[m(g,{class:"page-body__left",width:"200px"},{default:C((()=>[h("div",Ce,[(r(!0),s(T,null,w(o.labelList,(e=>(r(),s("div",{class:f(["ann-label__item",{active:e.id==o.activeLabel.id}]),key:e.id,onClick:a=>l.whenClickLabel(e)},[h("div",{class:"ann-label__color",style:F({backgroundColor:"#"+e.bgc})},null,4),h("span",_e,k(e.id),1),h("input",{type:"text",class:"ann-label__name",readonly:"",value:e.name},null,8,ye)],10,ve)))),128))]),h("div",be,[o.keyframes?(r(),s("span",ke,"已加载keyframes")):o.gettingKeyframes?(r(),s("span",xe," 正在获取keyframes...")):(r(),s(T,{key:2},[we,h("button",{type:"button",onClick:a[5]||(a[5]=(...e)=>l.genKeyframes&&l.genKeyframes(...e))},"生成keyframes")],64))]),v(h("textarea",{class:"page-body__output",readonly:"","onUpdate:modelValue":a[6]||(a[6]=e=>o.outputText=e),ref:"output"},null,512),[[N,o.outputText]])])),_:1}),m(U,null,{default:C((()=>[m(p,{class:"workspace__header",height:"54px"},{default:C((()=>[m(d,{align:"middle"},{default:C((()=>[m(c,{span:24},{default:C((()=>[m(i,{onClick:a[7]||(a[7]=e=>o.annTool.frameNum--)},{default:C((()=>[Te])),_:1}),m(i,{onClick:a[8]||(a[8]=e=>o.annTool.frameNum++)},{default:C((()=>[Se])),_:1}),m(i,{onClick:a[9]||(a[9]=e=>o.annTool.frameNum-=o.annTool.frameStep)},{default:C((()=>[Le])),_:1}),m(i,{onClick:a[10]||(a[10]=e=>o.annTool.frameNum+=o.annTool.frameStep)},{default:C((()=>[$e])),_:1}),m(i,{onClick:l.preKeyframe},{default:C((()=>[Ve])),_:1},8,["onClick"]),m(i,{onClick:l.nextKeyframe},{default:C((()=>[Fe])),_:1},8,["onClick"]),m(S,{inline:!0,style:{display:"inline-block"},size:"mini"},{default:C((()=>[m(y,{label:"当前帧"},{default:C((()=>[m(_,{modelValue:o.annTool.frameNum,"onUpdate:modelValue":a[11]||(a[11]=e=>o.annTool.frameNum=e),"controls-position":"right",min:0},null,8,["modelValue"])])),_:1}),m(y,{label:"步长"},{default:C((()=>[m(_,{modelValue:o.annTool.frameStep,"onUpdate:modelValue":a[12]||(a[12]=e=>o.annTool.frameStep=e),"controls-position":"right",min:1},null,8,["modelValue"])])),_:1})])),_:1}),m($,{modelValue:o.jumpMethod,"onUpdate:modelValue":a[13]||(a[13]=e=>o.jumpMethod=e)},{default:C((()=>[m(L,{label:"0"},{default:C((()=>[Me])),_:1}),m(L,{label:"1"},{default:C((()=>[Ne])),_:1}),m(L,{label:"2"},{default:C((()=>[We])),_:1})])),_:1},8,["modelValue"])])),_:1})])),_:1})])),_:1}),m(M,{class:"workspace"},{default:C((()=>[m(V,{ref:"workSpace"},null,512)])),_:1}),m(I,{class:"workspace__footer",height:"120px"},{default:C((()=>[m(D,{ref:"eCharts"},null,512)])),_:1})])),_:1}),m(g,{class:"page-body__right",width:"250px"},{default:C((()=>[m(U,{style:{height:"100%"}},{default:C((()=>[m(p,{height:"130px"},{default:C((()=>[h("div",De,null,512)])),_:1}),m(M,null,{default:C((()=>[m(R,null,{default:C((()=>[m(z,{modelValue:o.cvFunc,"onUpdate:modelValue":a[14]||(a[14]=e=>o.cvFunc=e)},null,8,["modelValue"]),m(i,{onClick:l.showfunc},{default:C((()=>[Ie])),_:1},8,["onClick"])])),_:1})])),_:1}),m(I,{height:"30px"},{default:C((()=>[Ue])),_:1})])),_:1})])),_:1})])),_:1})])),_:1})};let ze=Uint8ClampedArray;var Re=D({state:()=>({mCan_dic:{},cCan_dic:{},cWater_dic:{},mCan_undoL:[],mCan_redoL:[],cCan_undoL:[],cCan_redoL:[]}),getters:{getCWater:e=>a=>{let t=ze.from(V.inflate(e.cWater_dic[a]));return new ImageData(t,960,540)},getMCan:e=>a=>{let t=ze.from(V.inflate(e.mCan_dic[a]));return new ImageData(t,960,540)},getCCan:e=>a=>{let t=ze.from(V.inflate(e.cCan_dic[a]));return new ImageData(t,960,540)},getUndoMCan:(e,a)=>e.mCan_undoL[e.mCan_undoL.length-1],getUndoCCan:e=>e.cCan_undoL[e.cCan_undoL.length-1],toImgData:e=>e=>{let a=ze.from(V.inflate(e));return new ImageData(a,960,540)}},mutations:{canvasPushdo(e,a){e.cCan_undoL.push(V.deflate(a.cCanData.data)),e.mCan_undoL.push(V.deflate(a.mCanData.data)),e.cCan_undoL.length>100&&(e.cCan_undoL=e.cCan_undoL.slice(50,-1),e.mCan_undoL=e.mCan_undoL.slice(50,-1))},canvasUndo(e){e.cCan_undoL.length<=1||(e.cCan_redoL.push(e.cCan_undoL.pop()),e.mCan_redoL.push(e.mCan_undoL.pop()),e.cCan_redoL.length>100&&(e.cCan_redoL=e.cCan_redoL.slice(50,-1),e.mCan_redoL=e.mCan_redoL.slice(50,-1)))},canvasRedo(e){e.cCan_redoL.length<=0||(e.cCan_undoL.push(e.cCan_redoL.pop()),e.mCan_undoL.push(e.mCan_redoL.pop()),e.cCan_undoL.length>100&&(e.cCan_undoL=e.cCan_undoL.slice(50,-1),e.mCan_undoL=e.mCan_undoL.slice(50,-1)))},storeMCan(e,a){e.mCan_dic[a.num]=V.deflate(a.imgData.data)},storeCCan(e,a){e.cCan_dic[a.num]=V.deflate(a.imgData.data)},storeCWater(e,a){e.cWater_dic[a.num]=V.deflate(a.imgData.data)}}});const Ae=I(se);Ae.config.unwrapInjectedRef=!0,Ae.use(Re),Ae.use(U),Ae.provide("host","http://127.0.0.1:5000"),Ae.mount("#app");
